FROM amazoncorretto:19
ARG JAR_FILE=backend/streetdrop-api/build/libs/streetdrop-api-0.0.1-SNAPSHOT.jar
ARG DB_URL
ARG DB_USERNAME
ARG DB_PASSWORD
ARG SWAGGER_SERVER_URL
ARG AWS_ACCESS_KEY
ARG AWS_SECRET_KEY
ARG SLACK_TOKEN
ARG DOCKER_REPO

COPY ${JAR_FILE} app.jar

ENV DB_URL=${DB_URL}
ENV DB_USERNAME=${DB_USERNAME}
ENV DB_PASSWORD=${DB_PASSWORD}
ENV SWAGGER_SERVER_URL=${SWAGGER_SERVER_URL}
ENV AWS_ACCESS_KEY=${AWS_ACCESS_KEY}
ENV AWS_SECRET_KEY=${AWS_SECRET_KEY}
ENV AWS_BUCKET_NAME=${AWS_BUCKET_NAME}
ENV AWS_REGION=${AWS_REGION}
ENV SLACK_TOKEN=${SLACK_TOKEN}
ENV DOCKER_REPO=${DOCKER_REPO}

EXPOSE 8080
ENTRYPOINT ["java", "-jar", "-Djava.security.egd=file:/dev/./urandom", "/app.jar"]
